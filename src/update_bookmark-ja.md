# ブックマークを更新する

````admonish reset title="Reset your progress" collapsible=true
To reset your progress to the start of this chapter, run the following command:

```sh
curl https://jj-for-everyone.github.io/reset.sh | bash -s update_bookmark
cd ~/jj-tutorial/repo
```
````

新しいブックマークをリモートにプッシュする方法を学びました。
私たちは_毎回_新しいブックマークを作成してプッシュできます。
しかし、それは不要なブックマークがたくさん残るので、ひどい混乱になります！

幸い、より良い方法があります。
既存のブックマークを**移動**して、別のコミットをポイントする代わりに。
それを実験するために、まず新しいコミットを作成する必要があります。
これらのコマンドをコピーしてください：

```sh
printf "\nThis is a toy repository for learning Jujutsu.\n" >> README.md
jj commit -m "Add projcet description to readme"
```

ここに `commit` コマンドの巧妙なトリックがあります：
短い説明を心に留めている場合、`--message` の短縮形である `-m` フラグで直接渡すことができます。
それはより速い場合があります。

`jj log` はリモートにプッシュしたコミットの上に新しいコミットがあることを示します：

<!-- generated by aha script -->
<pre class="aha">
<span class="bold "></span><span class="bold green ">@</span>  <span class="bold "></span><span class="bold highlighted purple ">z</span><span class="bold highlighted dimgray ">zywylnt</span><span class="bold "> </span><span class="bold yellow ">alice@local</span><span class="bold "> </span><span class="bold highlighted cyan ">2025-07-22 20:36:38</span><span class="bold "> </span><span class="bold highlighted blue ">4</span><span class="bold highlighted dimgray ">8708b9f</span><span class="bold "></span>
│  <span class="bold "></span><span class="bold highlighted green ">(empty)</span><span class="bold "> </span><span class="bold highlighted green ">(no description set)</span><span class="bold "></span>
○  <span class="bold "></span><span class="bold purple ">k</span><span class="highlighted dimgray ">xqyrwux</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-07-22 20:36:38</span> <span class="green ">git_head()</span> <span class="bold "></span><span class="bold blue ">6</span><span class="highlighted dimgray ">ca38e90</span>
│  Add projcet description to readme
<span class="bold "></span><span class="bold highlighted cyan ">◆</span>  <span class="bold "></span><span class="bold purple ">m</span><span class="highlighted dimgray ">kmqlnox</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-07-22 20:25:40</span> <span class="purple ">main</span> <span class="bold "></span><span class="bold blue ">7</span><span class="highlighted dimgray ">939d4cf</span>
│  Add readme with project title
~
</pre>

今、ブックマークをそれにポイントするように移動できます、そしてブックマークを再度プッシュします。
ブックマークを移動することから始めましょう：

```sh
jj bookmark move main --to @-
```

`@-` はワーキングコピーコミットの**親**を参照する巧妙な方法です。
コミットを参照するための巧妙な方法が他にもたくさんありますが、それは将来のトピックです。
今は `@-` を覚えておいてください、それは最も有用なものです。

`jj log` が何と言うかを見てみましょう：

<!-- generated by aha script -->
<pre class="aha">
<span class="bold "></span><span class="bold green ">@</span>  <span class="bold "></span><span class="bold highlighted purple ">z</span><span class="bold highlighted dimgray ">zywylnt</span><span class="bold "> </span><span class="bold yellow ">alice@local</span><span class="bold "> </span><span class="bold highlighted cyan ">2025-07-22 20:36:38</span><span class="bold "> </span><span class="bold highlighted blue ">4</span><span class="bold highlighted dimgray ">8708b9f</span><span class="bold "></span>
│  <span class="bold "></span><span class="bold highlighted green ">(empty)</span><span class="bold "> </span><span class="bold highlighted green ">(no description set)</span><span class="bold "></span>
○  <span class="bold "></span><span class="bold purple ">k</span><span class="highlighted dimgray ">xqyrwux</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-07-22 20:36:38</span> <span class="purple ">main*</span> <span class="green ">git_head()</span> <span class="bold "></span><span class="bold blue ">6</span><span class="highlighted dimgray ">ca38e90</span>
│  Add projcet description to readme
<span class="bold "></span><span class="bold highlighted cyan ">◆</span>  <span class="bold "></span><span class="bold purple ">m</span><span class="highlighted dimgray ">kmqlnox</span> <span class="yellow ">alice@local</span> <span class="cyan ">2025-07-22 20:25:40</span> <span class="purple ">main@origin</span> <span class="bold "></span><span class="bold blue ">7</span><span class="highlighted dimgray ">939d4cf</span>
│  Add readme with project title
~
</pre>

重要なことは、Jujutsuがローカルブックマーク `main` とそのリモート対応の不一致を示していることです。
`main*` はローカルブックマークで、アスタリスクはリモートと同期していないことを意味します。
`main@origin` はリモート上のブックマークの場所です。

ブックマークを再度プッシュすることで状況を修正できます：

```sh
jj git push
```

この場合、`--bookmark main` を明示的に指定しませんでした。
ブックマークをプッシュする際に `--bookmark` フラグを省略すると、Jujutsuはプッシュしたいブックマークを推測しようとします。
それは通常かなりうまく動作します。
それが機能しないと思う場合、`--bookmark` フラグで再試行してください。

ブックマークが最初のコミットをポイントしなくなったことを疑問に思うかもしれません... それは今失われたり削除されたりするのでしょうか？
幸い、そうではありません。
コミットは親コミットを参照するので、Jujutsuは `jj log` の出力でコミットの順序を知っています。
ブックマークが付いたコミットは、そのすべての祖先も自動的に保護します。

```admonish success title="レベル1を完了しました！🎉"
あなたはそれを成し遂げました！
この時点で、適切なバックアップを持つ単独プロジェクトのための必要なスキルすべてを持っています。
ワークフローを再びまとめましょう：
1. 変更を行う
1. 新しいコミットを作成する
1. ブックマークを移動する
1. リモートにプッシュする

理想的には、今少し休憩を取り、学んだことを練習します。
それに慣れたら、すぐにレベル2に戻ってください、コラボレーションのためのスキルです。
それなしでは、コラボレーションが非常に困難になります！
```
